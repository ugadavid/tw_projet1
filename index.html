<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interface de saisie de notes - Bootstrap + jQuery</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <link rel="stylesheet" href="index.css">
</head>
<body class="bg-light">
  <div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="h4 mb-0">Saisie des Ã©lÃ¨ves & calcul des notes</h1>
      <button id="btnHelp" type="button" class="btn btn-sm btn-outline-secondary">
        Explications
      </button>
    </div>

    <p class="hint mb-4">Bootstrap 5 pour l'UI Â· jQuery 3.7 pour la logique Â· Pas d'autre lib.</p>

    <!-- Formulaire -->
    <div class="bg-white p-4 rounded-2xl shadow-soft mb-4">
      <form id="studentForm" class="row g-3" novalidate>
        <!-- Nom complet pour dÃ©montrer la sÃ©paration prÃ©nom/nom -->
        <div class="col-md-6">
          <label for="fullName" class="form-label">Nom complet (PrÃ©nom Nom)</label>
          <input type="text" class="form-control" id="fullName" placeholder="Ex: Jean Serge Patrice Dupont Durant" required>
          <div class="invalid-feedback">Saisir Â« PrÃ©nom Nom Â».</div>
          <div id="nameSplitHelper" class="form-text d-none">
            Cas multi-mots dÃ©tectÃ©. Choisir combien de <strong>mots de fin</strong> constituent le <em>nom de famille</em>.
            <div class="mt-2 d-flex align-items-center gap-2">
              <label class="form-label mb-0" for="lastCount">Nom (mots de fin)&nbsp;:</label>
              <select id="lastCount" class="form-select form-select-sm" style="max-width: 140px;"></select>
              <span id="namePreview" class="badge text-bg-light"></span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <label for="email" class="form-label">Email</label>
          <input type="email" class="form-control" id="email" placeholder="exemple@domaine.fr" required>
          <div class="invalid-feedback">Adresse email invalide.</div>
        </div>
        <div class="col-md-6">
          <label for="birth" class="form-label">Date de naissance</label>
          <input type="date" class="form-control" id="birth" required>
          <div class="invalid-feedback" id="birthFeedback">Indiquer une date valide.</div>
          <div class="form-text">Ã‚ge minimum appliquÃ© : <span id="minAgeLabel">16</span> ans. Aucune date future.</div>
        </div>
        <div class="col-md-6">
          <label for="rowColor" class="form-label">Couleur de fond (ligne)</label>
          <div class="input-group">
            <span class="input-group-text">ğŸ¨</span>
            <input type="color" class="form-control form-control-color" id="rowColor" value="#e8f4ff" title="Choisir une couleur">
          </div>
        </div>
        <div class="col-12">
          <label for="grades" class="form-label">Notes</label>
          <input type="text" class="form-control" id="grades" placeholder="Saisir plusieurs notes au format 14;15,6;8 (sÃ©parateur ';', dÃ©cimales avec virgule)" required>
          <div class="form-text">Chiffres uniquement. Valeurs acceptÃ©es : 0 Ã  20. Exemples valides : <code>12;18;19,5</code> â€¢ <code>0;20;13,25</code></div>
          <div class="invalid-feedback">Format invalide : utiliser Â« ; Â» comme sÃ©parateur, Â« , Â» pour dÃ©cimales, chaque note entre 0 et 20.</div>
        </div>
        <div class="col-12 d-flex flex-wrap gap-2">
          <button type="submit" class="btn btn-primary">Ajouter au tableau</button>
          <button type="reset" class="btn btn-outline-secondary" id="resetForm">RÃ©initialiser le formulaire</button>
          <button type="button" id="clearTable" class="btn btn-outline-danger">RÃ©initialiser le tableau</button>
        </div>
      </form>
    </div>

    <!-- Tableau -->
    <div class="bg-white p-3 rounded-2xl shadow-soft">
      <div class="table-responsive">
        <table class="table table-hover align-middle" id="studentsTable">
          <thead class="table-light">
            <tr>
              <th>PrÃ©nom</th>
              <th>Nom</th>
              <th>Email (anonymisÃ©)</th>
              <th>Date de naissance</th>
              <th>#</th>
              <th>Min</th>
              <th>Max</th>
              <th>Moy.</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Lignes insÃ©rÃ©es ici -->
          </tbody>
        </table>
      </div>
    </div>

    <!-- Explications (courtes) -->
    <div class="small text-secondary mt-3">
      <p class="mb-1"><strong>Conventions :</strong> Bootstrap 5 pour la grille, formulaires, table, utilitaires. jQuery 3.7 pour la logique DOM/Ã©vÃ©nements.</p>
      <ul class="mb-0">
        <li>Cas multi-noms : sÃ©lecteur <em>Â« mots de fin = nom de famille Â»</em> pour gÃ©rer les doubles noms/particules.</li>
        <li>Email anonymisÃ© â†’ <code>premiÃ¨re lettre + **** + @domaine</code> (ex: <code>d****@uga.fr</code>).</li>
        <li>Notes : sÃ©parÃ©es par <code>;</code>, virgule pour dÃ©cimales (<code>15,5</code>). Validation stricte 0-20.</li>
        <li>Date : pas de futur, Ã¢ge minimum (<span id="minAgeLabel2">16</span> ans).</li>
        <li>Suppression de ligne, bouton de rÃ©initialisation du tableau.</li>
      </ul>
    </div>
  </div>



  <div id="helpOverlay" class="help-overlay d-none" aria-hidden="true">
    <div class="help-modal" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
      <div class="help-header">
        <h2 id="helpTitle" class="h5 mb-0">Explications (structure & choix)</h2>
        <button id="btnHelpClose" type="button" class="btn-close" aria-label="Fermer"></button>
      </div>

      <div class="help-body">
        <p class="mb-2">
          Cette page permet de saisir un Ã©lÃ¨ve (nom/prÃ©nom, notes, mail, date de naissance, couleur) puis dâ€™ajouter une ligne
          dans le tableau avec des calculs automatiques (min, max, moyenne, nombre de notes) et une anonymisation du mail.
        </p>

        <h3 class="h6 mt-3">Organisation du code</h3>
        <ul class="mb-2">
          <li><strong>AppMain</strong> : point dâ€™entrÃ©e, instancie les modules.</li>
          <li><strong>UIHandlers</strong> : gÃ¨re le DOM et les Ã©vÃ©nements dâ€™interface (helper de nom, reset, etc.).</li>
          <li><strong>StudentManager</strong> : logique mÃ©tier (validation, calculs, ajout/suppression de lignes).</li>
          <li><strong>Utils</strong> : fonctions â€œpuresâ€ (parsing des notes, moyenne, anonymisation, etc.).</li>
          <li><strong>AppConfig</strong> : constantes, sÃ©lecteurs, paramÃ¨tres mÃ©tier (Ã¢ge minimum...).</li>
        </ul>

        <h3 class="h6 mt-3">Choix et cas traitÃ©s</h3>
        <ul class="mb-2">
          <li><strong>Noms composÃ©s / particules</strong> : tentative de gestion (ex. â€œdeâ€, â€œduâ€, â€œvanâ€, etc.) pour Ã©viter de couper au mauvais endroit.</li>
          <li><strong>Anonymisation mail</strong> : <code>sylvain.hatier@uga.fr</code> â†’ <code>s****@uga.fr</code>.</li>
          <li><strong>Notes</strong> : saisie multiple dans un champ (ex. <code>14;15,6;8</code>), puis calcul min/max/moyenne.</li>
        </ul>

        <h3 class="h6 mt-3">Limites (volontaires)</h3>
        <ul class="mb-0">
          <li>Le dÃ©coupage nom/prÃ©nom reste heuristique : <em>â€œBond, James Bondâ€</em> nâ€™est pas gÃ©rÃ© ğŸ˜„</li>
          <li>Le format des notes doit Ãªtre respectÃ© (sÃ©parateur â€œ;â€, virgule dÃ©cimale acceptÃ©e).</li>
        </ul>
      </div>

      <div class="help-footer">
        <button id="btnHelpOk" type="button" class="btn btn-primary">OK</button>
      </div>
    </div>
  </div>


  <!-- jQuery + Bootstrap -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

<script src="App/AppConfig.js"></script>
<script src="App/Utils.js"></script>
<script src="App/UIHandlers.js"></script>
<script src="App/StudentManager.js"></script>
<script src="App/AppMain.js"></script>

<script>
  AppMain.init();
</script>

</body>
</html>
